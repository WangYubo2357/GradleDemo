/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn more about Gradle by exploring our Samples at https://docs.gradle.org/9.1.0/samples
 * This project uses @Incubating APIs which are subject to change.
 */


// buildStarted 在 Gradle 9.x 中已被移除
// this.gradle.buildStarted {
//     println "---buildStarted---"
// }

//-------init开始-------
this.gradle.settingsEvaluated {
    println "---settings.gradle解析完成---"
}

this.gradle.projectsLoaded {
    println "---所有项目从settings加载完成---"
}
//-------init结束-------


// configuration阶段开始
this.gradle.beforeProject { project -> 
    println "---beforeProject---${project.name}"
}

this.gradle.afterProject {
    println "---afterProject---${project.name}"
}

this.gradle.projectsEvaluated {
    println "---所有项目构建完成---"
}

this.gradle.taskGraph.whenReady {
    println "---task图构建完成---"
}

// configuration阶段结束

// execution阶段开始
// 注意：在 Gradle 9.x 中，beforeTask 和 afterTask 与配置缓存不兼容
// 如果需要使用这些监听器，需要禁用配置缓存或使用其他方式

// 禁用配置缓存以使用任务监听器（可选）
// gradle.startParameter.configurationCacheEnabled = false

// 使用 Gradle 6.0+ 推荐的方式
gradle.taskGraph.whenReady { taskGraph ->
    taskGraph.allTasks.each { task ->
        task.doFirst {
            println "---beforeTask---${task.name}"
        }
        task.doLast {
            println "---afterTask---${task.name}"
        }
    }
}

// execution阶段结束